---
title: å¹³å‡å”®ä»·-LeetCode
categories: ä½œä¸šç»ƒä¹ 
tags:
  - LeetCode
æ•°æ®ç»“æ„:
  - sql
date: 2025-12-09
---
# å¹³å‡å”®ä»·

## ğŸ¯ é—®é¢˜æè¿°ï¼ˆæ¥æºäºLeetCodeï¼‰
**æè¿°**ï¼š
è¡¨ï¼š`Prices`
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| product_id    | int     |
| start_date    | date    |
| end_date      | date    |
| price         | int     |
+---------------+---------+
(product_idï¼Œstart_dateï¼Œend_date) æ˜¯ `prices` è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
`prices` è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºçš„æ˜¯æŸä¸ªäº§å“åœ¨ä¸€æ®µæ—¶æœŸå†…çš„ä»·æ ¼ã€‚
æ¯ä¸ªäº§å“çš„å¯¹åº”æ—¶é—´æ®µæ˜¯ä¸ä¼šé‡å çš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€åŒä¸€ä¸ªäº§å“çš„ä»·æ ¼æ—¶æ®µä¸ä¼šå‡ºç°äº¤å‰ã€‚
è¡¨ï¼š`UnitsSold`
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| product_id    | int     |
| purchase_date | date    |
| units         | int     |
+---------------+---------+
è¯¥è¡¨å¯èƒ½åŒ…å«é‡å¤æ•°æ®ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºçš„æ˜¯æ¯ç§äº§å“çš„å‡ºå”®æ—¥æœŸï¼Œå•ä½å’Œäº§å“ idã€‚
ç¼–å†™è§£å†³æ–¹æ¡ˆä»¥æŸ¥æ‰¾æ¯ç§äº§å“çš„å¹³å‡å”®ä»·ã€‚`average_price`Â åº”è¯¥Â **å››èˆäº”å…¥åˆ°å°æ•°ç‚¹åä¸¤ä½**ã€‚å¦‚æœäº§å“æ²¡æœ‰ä»»ä½•å”®å‡ºï¼Œåˆ™å‡è®¾å…¶å¹³å‡å”®ä»·ä¸º 0ã€‚
**è¦æ±‚**ï¼š
è¿”å›ç»“æœè¡¨Â **æ— é¡ºåºè¦æ±‚**Â ã€‚
**è¯´æ˜**ï¼š

**ç¤ºä¾‹**ï¼š

- ç¤ºä¾‹ 1ï¼š
**è¾“å…¥ï¼š**
Prices table:
+------------+------------+------------+--------+
| product_id | start_date | end_date   | price  |
+------------+------------+------------+--------+
| 1          | 2019-02-17 | 2019-02-28 | 5      |
| 1          | 2019-03-01 | 2019-03-22 | 20     |
| 2          | 2019-02-01 | 2019-02-20 | 15     |
| 2          | 2019-02-21 | 2019-03-31 | 30     |
+------------+------------+------------+--------+
UnitsSold table:
+------------+---------------+-------+
| product_id | purchase_date | units |
+------------+---------------+-------+
| 1          | 2019-02-25    | 100   |
| 1          | 2019-03-01    | 15    |
| 2          | 2019-02-10    | 200   |
| 2          | 2019-03-22    | 30    |
+------------+---------------+-------+
**è¾“å‡ºï¼š**
+------------+---------------+
| product_id | average_price |
+------------+---------------+
| 1          | 6.96          |
| 2          | 16.96         |
+------------+---------------+
**è§£é‡Šï¼š**
å¹³å‡å”®ä»· = äº§å“æ€»ä»· / é”€å”®çš„äº§å“æ•°é‡ã€‚
äº§å“ 1 çš„å¹³å‡å”®ä»· = ((100 * 5)+(15 * 20) )/ 115 = 6.96
äº§å“ 2 çš„å¹³å‡å”®ä»· = ((200 * 15)+(30 * 30) )/ 230 = 16.96
## ğŸ’» è§£é¢˜æ€è·¯
### æ€è·¯1ï¼šæ¨¡æ‹Ÿè¿‡ç¨‹
#### æ€è·¯1ï¼šä»£ç å®ç°
```sql
# Write your MySQL query statement below
SELECT p.product_id,ROUND(ifnull(SUM(units*price)/SUM(units),0),2)AS average_price
FROM prices p
LEFT JOIN unitsSold u
ON p.product_id=u.product_id and u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id
```
#### æ€è·¯1ï¼šğŸ“Š æ€§èƒ½åˆ†æ
##### æäº¤ç»“æœ
- **è¿è¡Œæ—¶é—´**ï¼š1155mså‡»è´¥75.29%
#### æ€è€ƒ
ROUNDã€ifnullå‡½æ•°ä¸€å®šè¦çŸ¥é“å‚æ•°